<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
  <script src="./Excel.js"></script>
  <title>Iot-Device-Connector!</title>
</head>

<body>
  <form id="mainfrm">
    <h3>Iot-Device-Connector Spreadsheet Generator</h3>

    <!-- Spreadsheet Name -->
    <label for="ssname">Spreadsheet Name:</label>
    <input type="text" id="ssname" name="ssname" /><br /><br />

    <!-- Available Sheets -->
    <div id="sheetnames" style="display: none">
    <label for="sname">Sheet Names:</label>
    <select id="sname" name="sname" onChange="generateSheetForm(this.value);">
      <!-- <option value="DeviceType" selected>DeviceType</option> -->
      <option></option>
      <option value="DeviceType" >DeviceType</option>
      <option value="DeviceInterface">DeviceInterface</option>
      <option value="DevicePhysical">DevicePhysical</option>
      <option value="TelemetryPoint">TelemetryPoint</option>
      <option value="ActuationPoint">ActuationPoint</option>
    </select><br /><br />
    </div>
  </form>

  <form id="devicetypefrm" style="display: none">
    <h3>Form to enter DeviceType data</h3>
    <label for="devicetypename">DeviceTypeName:</label>
    <input type="text" id="devicetypename" name="devicetypename" /><br /><br />
    <label for="manufacturer">Manufacturer:</label>
    <input type="text" id="manufacturer" name="manufacturer" /><br /><br />
    <label for="modelnumber">ModelNumber:</label>
    <input type="text" id="modelnumber" name="modelnumber" /><br /><br />
    <label for="devicekind">DeviceKind:</label>
    <input type="text" id="devicekind" name="devicekind" /><br /><br />
    <!-- <button onclick="saveFormData()">Save Data</button><br /><br /> -->
  </form>

  <form id="deviceinterfacefrm" style="display: none">
    <h3>Form to enter DeviceInterface data</h3>
    <label for="devicename">DeviceName:</label>
    <input type="text" id="devicename" name="devicename" /><br /><br />
    <label for="devicetypename">DeviceTypeName:</label>
    <input type="text" id="devicetypename" name="devicetypename" /><br /><br />
    <label for="iotid">IoTId:</label>
    <input type="text" id="iotid" name="iotid" /><br /><br />
    <label for="physicalelement">PhysicalElement:</label>
    <input type="text" id="physicalelement" name="physicalelement" /><br /><br />
    <!-- <button onclick="saveFormData()">Save Data</button><br /><br /> -->
  </form>

  <form id="devicephysicalfrm" style="display: none">
    <h3>Form to enter DevicePhysical data</h3>
    <label for="pdevicename">DeviceName:</label>
    <input type="text" id="pdevicename" name="pdevicename" /><br /><br />
    <label for="locationpoint">LocationPoint:</label>
    <input type="text" id="locationpoint" name="locationpoint" /><br /><br />
    <label for="categoryname">CategoryName:</label>
    <input type="text" id="categoryname" name="categoryname" /><br /><br />
    <!-- <button onclick="saveFormData()">Save Data</button><br /><br /> -->
  </form>

  <form id="telemetrypointfrm" style="display: none">
    <h3>Form to enter TelemetryPoint data</h3>
    <label for="observationname">ObservationName:</label>
    <input type="text" id="observationname" name="observationname" /><br /><br />
    <label for="phenomenon">Phenomenon:</label>
    <input type="text" id="phenomenon" name="phenomenon" /><br /><br />
    <label for="tdevicename">DeviceName:</label>
    <input type="text" id="tdevicename" name="tdevicename" /><br /><br />
    <label for="observedelement">ObservedElement:</label>
    <input type="text" id="observedelement" name="observedelement" /><br /><br />
    <label for="tiotid">IoTId:</label>
    <input type="text" id="tiotid" name="tiotid" /><br /><br />
    <!-- <button onclick="saveFormData()">Save Data</button><br /><br /> -->
  </form>

  <form id="actuationpointfrm" style="display: none">
    <h3>Form to enter ActuationPoint data</h3>
    <label for="actuationname">ActuationName:</label>
    <input type="text" id="actuationname" name="actuationname" /><br /><br />
    <label for="adevicename">DeviceName:</label>
    <input type="text" id="adevicename" name="adevicename" /><br /><br />
    <label for="aiotid">IoTId:</label>
    <input type="text" id="aiotid" name="aiotid" /><br /><br />
    <!-- <button onclick="saveFormData()">Save Data</button><br /><br /> -->
  </form>

  <script>
    function generateSheetForm(value) {
      switch (value) {
        case "DeviceType":
          document.getElementById("mainfrm").style.display = "block";
          document.getElementById("devicetypefrm").style.display = "block";
          document.getElementById("deviceinterfacefrm").style.display = "none";
          document.getElementById("telemetrypointfrm").style.display = "none";
          document.getElementById("devicephysicalfrm").style.display = "none";
          document.getElementById("actuationpointfrm").style.display = "none";
          document.getElementById("saveData").disabled = false;
          break;

        case "DeviceInterface":
          document.getElementById("mainfrm").style.display = "block";
          document.getElementById("devicetypefrm").style.display = "none";
          document.getElementById("deviceinterfacefrm").style.display = "block";
          document.getElementById("telemetrypointfrm").style.display = "none";
          document.getElementById("devicephysicalfrm").style.display = "none";
          document.getElementById("actuationpointfrm").style.display = "none";
          document.getElementById("saveData").disabled = false;
          break;

        case "DevicePhysical":
          document.getElementById("mainfrm").style.display = "block";
          document.getElementById("devicetypefrm").style.display = "none";
          document.getElementById("deviceinterfacefrm").style.display = "none";
          document.getElementById("telemetrypointfrm").style.display = "none";
          document.getElementById("devicephysicalfrm").style.display = "block";
          document.getElementById("actuationpointfrm").style.display = "none";
          document.getElementById("saveData").disabled = false;
          break;

        case "TelemetryPoint":
          document.getElementById("mainfrm").style.display = "block";
          document.getElementById("devicetypefrm").style.display = "none";
          document.getElementById("deviceinterfacefrm").style.display = "none";
          document.getElementById("telemetrypointfrm").style.display = "block";
          document.getElementById("devicephysicalfrm").style.display = "none";
          document.getElementById("actuationpointfrm").style.display = "none";
          document.getElementById("saveData").disabled = false;
          break;

        case "ActuationPoint":
          document.getElementById("mainfrm").style.display = "block";
          document.getElementById("devicetypefrm").style.display = "none";
          document.getElementById("deviceinterfacefrm").style.display = "none";
          document.getElementById("telemetrypointfrm").style.display = "none";
          document.getElementById("devicephysicalfrm").style.display = "none";
          document.getElementById("actuationpointfrm").style.display = "block";
          document.getElementById("saveData").disabled = false;
          break;

        default:
          document.getElementById("mainfrm").style.display = "block";
          document.getElementById("devicetypefrm").style.display = "none";
          document.getElementById("deviceinterfacefrm").style.display = "none";
          document.getElementById("telemetrypointfrm").style.display = "none";
          document.getElementById("devicephysicalfrm").style.display = "none";
          document.getElementById("actuationpointfrm").style.display = "none";
          document.getElementById("saveData").disabled = false;
      }
    }
  </script>

  <button id= "createExcel" onclick="createExcel()" >Create Spreadsheet</button><nbsp /><nbsp />
  <button id= "saveData" onclick="saveFormData()" disabled>Save Data</button><br /><br />
</body>

</html>